<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started with GPU-Accelerated Differential Equations in Julia · DiffEqGPU.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/DiffEqGPU/stable/getting_started/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="DiffEqGPU.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DiffEqGPU.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">DiffEqGPU: Massively Data-Parallel GPU Solving of ODEs</a></li><li class="is-active"><a class="tocitem" href>Getting Started with GPU-Accelerated Differential Equations in Julia</a><ul class="internal"><li><a class="tocitem" href="#The-two-ways-to-accelerate-ODE-solvers-with-GPUs"><span>The two ways to accelerate ODE solvers with GPUs</span></a></li><li><a class="tocitem" href="#Simple-Example-of-Within-Method-GPU-Parallelism"><span>Simple Example of Within-Method GPU Parallelism</span></a></li><li><a class="tocitem" href="#Example-of-Parameter-Parallelism-with-GPU-Ensemble-Methods"><span>Example of Parameter-Parallelism with GPU Ensemble Methods</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">GPU Ensembles</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/gpu_ensemble_basic/">Massively Data-Parallel ODE Solving the Lorenz Equation</a></li><li><a class="tocitem" href="../tutorials/parallel_callbacks/">Massively Parallel ODE Solving with Event Handling and Callbacks</a></li><li><a class="tocitem" href="../tutorials/multigpu/">Setting Up Multi-GPU Parallel Parameter Sweeps</a></li><li><a class="tocitem" href="../tutorials/lower_level_api/">Using the Lower Level API for Decreased Overhead with GPU acclerated Ensembles</a></li><li><a class="tocitem" href="../tutorials/weak_order_conv_sde/">Using the EnsembleGPUKernel SDE solvers for the expectation of SDEs </a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Within-Method GPU</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/within_method_gpu/">Within-Method GPU Parallelism of Ordinary Differential Equation Solves</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">GPU Ensembles</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/sde/">GPU Parallel Solving of Stochastic Differential Equations</a></li><li><a class="tocitem" href="../examples/ad/">Using GPU-accelerated Ensembles with Automatic Differentiation</a></li><li><a class="tocitem" href="../examples/reductions/">Batched Reductions for Lowering Peak Memory Requirements</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Within-Method GPU</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/reaction_diffusion/">GPU-Accelerated Stochastic Partial Differential Equations</a></li><li><a class="tocitem" href="../examples/bruss/">GPU-Acceleration of a Stiff Nonlinear Partial Differential Equation</a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../manual/ensemblegpukernel/">EnsembleGPUKernel</a></li><li><a class="tocitem" href="../manual/ensemblegpuarray/">EnsembleGPUArray</a></li><li><a class="tocitem" href="../manual/optimal_trajectories/">Choosing Optimal Numbers of Trajectories</a></li><li><a class="tocitem" href="../manual/choosing_ensembler/">Choosing the Ensemble: EnsembleGPUArray vs EnsembleGPUKernel</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started with GPU-Accelerated Differential Equations in Julia</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started with GPU-Accelerated Differential Equations in Julia</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DiffEqGPU.jl/blob/master/docs/src/getting_started.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started-with-GPU-Accelerated-Differential-Equations-in-Julia"><a class="docs-heading-anchor" href="#Getting-Started-with-GPU-Accelerated-Differential-Equations-in-Julia">Getting Started with GPU-Accelerated Differential Equations in Julia</a><a id="Getting-Started-with-GPU-Accelerated-Differential-Equations-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started-with-GPU-Accelerated-Differential-Equations-in-Julia" title="Permalink"></a></h1><h2 id="The-two-ways-to-accelerate-ODE-solvers-with-GPUs"><a class="docs-heading-anchor" href="#The-two-ways-to-accelerate-ODE-solvers-with-GPUs">The two ways to accelerate ODE solvers with GPUs</a><a id="The-two-ways-to-accelerate-ODE-solvers-with-GPUs-1"></a><a class="docs-heading-anchor-permalink" href="#The-two-ways-to-accelerate-ODE-solvers-with-GPUs" title="Permalink"></a></h2><p>There are two very different ways that one can accelerate an ODE solution with GPUs. There is one case where <code>u</code> is very big and <code>f</code> is very expensive but very structured, and you use GPUs to accelerate the computation of said <code>f</code>. The other use case is where <code>u</code> is very small, but you want to solve the ODE <code>f</code> over many different initial conditions (<code>u0</code>) or parameters <code>p</code>. In that case, you can use GPUs to parallelize over different parameters and initial conditions. In other words:</p><table><tr><th style="text-align: left">Type of Problem</th><th style="text-align: left">SciML Solution</th></tr><tr><td style="text-align: left">Accelerate a big ODE</td><td style="text-align: left">Use <a href="https://cuda.juliagpu.org/stable/">CUDA.jl&#39;s</a> CuArray as <code>u0</code></td></tr><tr><td style="text-align: left">Solve the same ODE with many <code>u0</code> and <code>p</code></td><td style="text-align: left">Use <a href="https://docs.sciml.ai/DiffEqGPU/stable/">DiffEqGPU.jl&#39;s</a> <code>EnsembleGPUArray</code> and <code>EnsembleGPUKernel</code></td></tr></table><h2 id="Simple-Example-of-Within-Method-GPU-Parallelism"><a class="docs-heading-anchor" href="#Simple-Example-of-Within-Method-GPU-Parallelism">Simple Example of Within-Method GPU Parallelism</a><a id="Simple-Example-of-Within-Method-GPU-Parallelism-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-Example-of-Within-Method-GPU-Parallelism" title="Permalink"></a></h2><p>The following is a quick and dirty example of doing within-method GPU parallelism. Let&#39;s say we had a simple but large ODE with many linear algebra or map/broadcast operations:</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, LinearAlgebra
u0 = rand(1000)
A = randn(1000, 1000)
f(du, u, p, t) = mul!(du, A, u)
prob = ODEProblem(f, u0, (0.0, 1.0))
sol = solve(prob, Tsit5())</code></pre><p>Translating this to a GPU-based solve of the ODE simply requires moving the arrays for the initial condition, parameters, and caches to the GPU. This looks like:</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, CUDA, LinearAlgebra
u0 = cu(rand(1000))
A = cu(randn(1000, 1000))
f(du, u, p, t) = mul!(du, A, u)
prob = ODEProblem(f, u0, (0.0f0, 1.0f0)) # Float32 is better on GPUs!
sol = solve(prob, Tsit5())</code></pre><p>Notice that the solution values <code>sol[i]</code> are CUDA-based arrays, which can be moved back to the CPU using <code>Array(sol[i])</code>.</p><p>More details on effective use of within-method GPU parallelism can be found in <a href="../tutorials/within_method_gpu/#withingpu">the within-method GPU parallelism tutorial</a>.</p><h2 id="Example-of-Parameter-Parallelism-with-GPU-Ensemble-Methods"><a class="docs-heading-anchor" href="#Example-of-Parameter-Parallelism-with-GPU-Ensemble-Methods">Example of Parameter-Parallelism with GPU Ensemble Methods</a><a id="Example-of-Parameter-Parallelism-with-GPU-Ensemble-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-Parameter-Parallelism-with-GPU-Ensemble-Methods" title="Permalink"></a></h2><p>On the other side of the spectrum, what if we want to solve tons of small ODEs? For this use case, we would use the ensemble methods to solve the same ODE many times with different parameters. This looks like:</p><pre><code class="language-julia hljs">using DiffEqGPU, OrdinaryDiffEq, StaticArrays

function lorenz(u, p, t)
    σ = p[1]
    ρ = p[2]
    β = p[3]
    du1 = σ * (u[2] - u[1])
    du2 = u[1] * (ρ - u[3]) - u[2]
    du3 = u[1] * u[2] - β * u[3]
    return SVector{3}(du1, du2, du3)
end

u0 = @SVector [1.0f0; 0.0f0; 0.0f0]
tspan = (0.0f0, 10.0f0)
p = @SVector [10.0f0, 28.0f0, 8 / 3.0f0]
prob = ODEProblem{false}(lorenz, u0, tspan, p)
prob_func = (prob, i, repeat) -&gt; remake(prob, p = (@SVector rand(Float32, 3)) .* p)
monteprob = EnsembleProblem(prob, prob_func = prob_func, safetycopy = false)

sol = solve(monteprob, GPUTsit5(), EnsembleGPUKernel(), trajectories = 10_000)</code></pre><p>To dig more into this example, see the <a href="../tutorials/gpu_ensemble_basic/#lorenz">ensemble GPU solving tutorial</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« DiffEqGPU: Massively Data-Parallel GPU Solving of ODEs</a><a class="docs-footer-nextpage" href="../tutorials/gpu_ensemble_basic/">Massively Data-Parallel ODE Solving the Lorenz Equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 04:11">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
